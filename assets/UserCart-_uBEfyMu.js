import{S as f,a as w}from"./sweetalert2.all-BP0Kp5-G.js";import{_ as E,m as p,g as b,r as h,o as i,c as d,a as e,F as g,h as v,k,t as m,b as n,w as x,d as M,n as _,D as U,E as I}from"./index-7nF7zO-F.js";import{c as y}from"./cartStore-Ml0MIDPi.js";import{s as V}from"./sweetMessageStore-rRz5Jm6g.js";var T={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"ming777",BASE_URL:"/YoJapan/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:q,VITE_PATH:A}=T,D={data(){return{form:{user:{email:"",name:"",tel:"",address:""},message:""}}},methods:{...p(y,["getCart","changeQty","removeCartAllItem","removeCartItem"]),...p(V,["setSweetMessageSuccess","setSweetMessageError"]),createOrder(){if(this.carts.carts.length===0)this.setSweetMessageError("購物車是空的 無法送出訂單"),f.fire(this.sweetMessage);else{const a=this.form;w.post(`${q}/api/${A}/order`,{data:a}).then(s=>{this.setSweetMessageSuccess(s.data.message),this.$refs.form.resetForm(),this.form.message="",this.getCart(),f.fire(this.sweetMessage)}).catch(s=>{this.setSweetMessageError(s.response.data.message),f.fire(this.sweetMessage)})}}},mounted(){this.getCart()},computed:{...b(y,["carts","cartCount"]),...b(V,["sweetMessage"])}},R={class:"container"},B={class:"text-end"},L=["disabled"],N={key:0,class:"text-center"},O={key:1,class:"table align-middle"},F=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),P=["onClick"],H=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),Q={class:"input-group input-group-sm"},j={class:"input-group mb-3"},z=["value","onChange"],J=["value"],Y={class:"input-group-text",id:"basic-addon2"},G={class:"text-end"},K=e("td",{colspan:"3",class:"text-end"},"總計",-1),W={class:"text-end"},X={class:"my-5 row justify-content-center"},Z={class:"mb-3"},$=e("label",{for:"email",class:"form-label"},"Email",-1),ee={class:"mb-3"},se=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),te={class:"mb-3"},ae=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),oe={class:"mb-3"},le=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ne={class:"mb-3"},re=e("label",{for:"message",class:"form-label"},"留言",-1),ie={class:"text-end"},de=["disabled"];function me(a,s,ce,ue,l,C){const c=h("v-field"),u=h("error-message"),S=h("v-form");return i(),d("div",R,[e("div",B,[e("button",{class:"btn btn-outline-danger",type:"button",disabled:a.cartCount===0,onClick:s[0]||(s[0]=t=>a.removeCartAllItem())}," 清空購物車 ",8,L)]),a.cartCount===0?(i(),d("h2",N,"目前購物車是空的")):(i(),d("table",O,[F,e("tbody",null,[a.carts.carts?(i(!0),d(g,{key:0},v(a.carts.carts,(t,o)=>(i(),d("tr",{key:o},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r=>a.removeCartItem(t.id)},[H,M(" x ")],8,P)]),e("td",null,m(t.product.title),1),e("td",null,[e("div",Q,[e("div",j,[e("select",{class:"form-select",name:"qty",id:"qty",value:t.qty,onChange:r=>a.changeQty(t.id,t.product_id,r)},[(i(),d(g,null,v(20,r=>e("option",{value:r,key:r},m(r),9,J)),64))],40,z),e("span",Y,m(t.product.unit),1)])])]),e("td",G,m(t.total),1)]))),128)):k("",!0)]),e("tfoot",null,[e("tr",null,[K,e("td",W,m(a.carts.final_total),1)])])])),e("div",X,[n(S,{ref:"form",class:"col-md-6",onSubmit:C.createOrder},{default:x(({errors:t})=>[e("div",Z,[$,n(c,{id:"email",name:"Email",type:"email",class:_(["form-control",{"is-invalid":t.Email}]),rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=o=>l.form.user.email=o),placeholder:"請輸入 Email"},null,8,["modelValue","class"]),n(u,{name:"Email",class:"invalid-feedback"})]),e("div",ee,[se,n(c,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":t.姓名}]),rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=o=>l.form.user.name=o),placeholder:"請輸入姓名"},null,8,["modelValue","class"]),n(u,{name:"姓名",class:"invalid-feedback"})]),e("div",te,[ae,n(c,{id:"tel",name:"電話",type:"tel",class:_(["form-control",{"is-invalid":t.電話}]),rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=o=>l.form.user.tel=o),placeholder:"請輸入電話"},null,8,["modelValue","class"]),n(u,{name:"電話",class:"invalid-feedback"})]),e("div",oe,[le,n(c,{id:"address",name:"地址",type:"text",class:_(["form-control",{"is-invalid":t.地址}]),rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=o=>l.form.user.address=o),placeholder:"請輸入地址"},null,8,["modelValue","class"]),n(u,{name:"地址",class:"invalid-feedback"})]),e("div",ne,[re,U(e("textarea",{name:"",id:"message",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=o=>l.form.message=o),cols:"30",rows:"10"},null,512),[[I,l.form.message]])]),e("div",ie,[e("button",{type:"submit",class:"btn btn-danger",disabled:a.cartCount===0},"送出訂單",8,de)])]),_:1},8,["onSubmit"])])])}const be=E(D,[["render",me]]);export{be as default};
