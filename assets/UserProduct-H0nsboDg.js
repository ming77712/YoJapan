import{_ as H,r as B,o as T,c as E,b as A,w as P,F as L,i as F,h as z,d as i,n as X,m as $,a as N,t as y,g as k,j as V,p as Y,f as J}from"./index-NnlbEwpK.js";import{p as Q}from"./productsStore-wPfc5AL6.js";import{c as G}from"./cartStore-eSiOfBHX.js";import{g as K,j as W,e as Z,n as O,h as R,S as ee,i as te}from"./swiper-o22jeolg.js";import"./sweetalert2.all-FS2xVMHR.js";import"./sweetMessageStore-aReIbNgC.js";function se(m){let{swiper:e,extendParams:g,on:h}=m;g({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let p=!1,w=!1;e.thumbs={swiper:null};function _(){const s=e.thumbs.swiper;if(!s||s.destroyed)return;const t=s.clickedIndex,l=s.clickedSlide;if(l&&l.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof t>"u"||t===null)return;let d;s.params.loop?d=parseInt(s.clickedSlide.getAttribute("data-swiper-slide-index"),10):d=t,e.params.loop?e.slideToLoop(d):e.slideTo(d)}function b(){const{thumbs:s}=e.params;if(p)return!1;p=!0;const t=e.constructor;if(s.swiper instanceof t)e.thumbs.swiper=s.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(W(s.swiper)){const l=Object.assign({},s.swiper);Object.assign(l,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new t(l),w=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",_),!0}function n(s){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const l=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():t.params.slidesPerView;let d=1;const a=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(d=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(d=1),d=Math.floor(d),t.slides.forEach(u=>u.classList.remove(a)),t.params.loop||t.params.virtual&&t.params.virtual.enabled)for(let u=0;u<d;u+=1)Z(t.slidesEl,`[data-swiper-slide-index="${e.realIndex+u}"]`).forEach(o=>{o.classList.add(a)});else for(let u=0;u<d;u+=1)t.slides[e.realIndex+u]&&t.slides[e.realIndex+u].classList.add(a);const c=e.params.thumbs.autoScrollOffset,S=c&&!t.params.loop;if(e.realIndex!==t.realIndex||S){const u=t.activeIndex;let o,x;if(t.params.loop){const r=t.slides.filter(M=>M.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];o=t.slides.indexOf(r),x=e.activeIndex>e.previousIndex?"next":"prev"}else o=e.realIndex,x=o>e.previousIndex?"next":"prev";S&&(o+=x==="next"?c:-1*c),t.visibleSlidesIndexes&&t.visibleSlidesIndexes.indexOf(o)<0&&(t.params.centeredSlides?o>u?o=o-Math.floor(l/2)+1:o=o+Math.floor(l/2)-1:o>u&&t.params.slidesPerGroup,t.slideTo(o,s?0:void 0))}}h("beforeInit",()=>{const{thumbs:s}=e.params;if(!(!s||!s.swiper))if(typeof s.swiper=="string"||s.swiper instanceof HTMLElement){const t=K(),l=()=>{const a=typeof s.swiper=="string"?t.querySelector(s.swiper):s.swiper;if(a&&a.swiper)s.swiper=a.swiper,b(),n(!0);else if(a){const c=S=>{s.swiper=S.detail[0],a.removeEventListener("init",c),b(),n(!0),s.swiper.update(),e.update()};a.addEventListener("init",c)}return a},d=()=>{if(e.destroyed)return;l()||requestAnimationFrame(d)};requestAnimationFrame(d)}else b(),n(!0)}),h("slideChange update resize observerUpdate",()=>{n()}),h("setTransition",(s,t)=>{const l=e.thumbs.swiper;!l||l.destroyed||l.setTransition(t)}),h("beforeDestroy",()=>{const s=e.thumbs.swiper;!s||s.destroyed||w&&s.destroy()}),Object.assign(e.thumbs,{init:b,update:n})}function ie(m){let{swiper:e,extendParams:g,emit:h,once:p}=m;g({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function w(){if(e.params.cssMode)return;const n=e.getTranslate();e.setTranslate(n),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function _(){if(e.params.cssMode)return;const{touchEventsData:n,touches:s}=e;n.velocities.length===0&&n.velocities.push({position:s[e.isHorizontal()?"startX":"startY"],time:n.touchStartTime}),n.velocities.push({position:s[e.isHorizontal()?"currentX":"currentY"],time:O()})}function b(n){let{currentPos:s}=n;if(e.params.cssMode)return;const{params:t,wrapperEl:l,rtlTranslate:d,snapGrid:a,touchEventsData:c}=e,u=O()-c.touchStartTime;if(s<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(s>-e.maxTranslate()){e.slides.length<a.length?e.slideTo(a.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(c.velocities.length>1){const f=c.velocities.pop(),v=c.velocities.pop(),U=f.position-v.position,j=f.time-v.time;e.velocity=U/j,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(j>150||O()-f.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,c.velocities.length=0;let o=1e3*t.freeMode.momentumRatio;const x=e.velocity*o;let r=e.translate+x;d&&(r=-r);let M=!1,I;const C=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let D;if(r<e.maxTranslate())t.freeMode.momentumBounce?(r+e.maxTranslate()<-C&&(r=e.maxTranslate()-C),I=e.maxTranslate(),M=!0,c.allowMomentumBounce=!0):r=e.maxTranslate(),t.loop&&t.centeredSlides&&(D=!0);else if(r>e.minTranslate())t.freeMode.momentumBounce?(r-e.minTranslate()>C&&(r=e.minTranslate()+C),I=e.minTranslate(),M=!0,c.allowMomentumBounce=!0):r=e.minTranslate(),t.loop&&t.centeredSlides&&(D=!0);else if(t.freeMode.sticky){let f;for(let v=0;v<a.length;v+=1)if(a[v]>-r){f=v;break}Math.abs(a[f]-r)<Math.abs(a[f-1]-r)||e.swipeDirection==="next"?r=a[f]:r=a[f-1],r=-r}if(D&&p("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(d?o=Math.abs((-r-e.translate)/e.velocity):o=Math.abs((r-e.translate)/e.velocity),t.freeMode.sticky){const f=Math.abs((d?-r:r)-e.translate),v=e.slidesSizesGrid[e.activeIndex];f<v?o=t.speed:f<2*v?o=t.speed*1.5:o=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&M?(e.updateProgress(I),e.setTransition(o),e.setTranslate(r),e.transitionStart(!0,e.swipeDirection),e.animating=!0,R(l,()=>{!e||e.destroyed||!c.allowMomentumBounce||(h("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(I),R(l,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(h("_freeModeNoMomentumRelease"),e.updateProgress(r),e.setTransition(o),e.setTranslate(r),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,R(l,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(r),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&h("_freeModeNoMomentumRelease");(!t.freeMode.momentum||u>=t.longSwipesMs)&&(h("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:w,onTouchMove:_,onTouchEnd:b}})}const re={props:["images"],data(){return{imagesLength:0,thumbsSwiper:{value:null},modules:[ie,se]}},methods:{setThumbsSwiper(m){this.thumbsSwiper.value=m}},computed:{activeSlideIndex(){return this.thumbsSwiper.value?this.thumbsSwiper.value.realIndex:0}},watch:{images(){this.imagesLength=this.images.length}},components:{Swiper:ee,SwiperSlide:te}},oe=["src"],ne=["src"];function ae(m,e,g,h,p,w){const _=B("swiper-slide"),b=B("swiper");return T(),E(L,null,[A(b,{thumbs:{swiper:p.thumbsSwiper.value},modules:p.modules,class:"mb-6"},{default:P(()=>[(T(!0),E(L,null,F(g.images,(n,s)=>(T(),z(_,{class:"swiper-slide-thumb-active",key:s},{default:P(()=>[i("img",{class:"grab w-100",src:n,alt:"",style:{height:"400px"}},null,8,oe)]),_:2},1024))),128))]),_:1},8,["thumbs","modules"]),A(b,{onSwiper:w.setThumbsSwiper,spaceBetween:10,slidesPerView:p.imagesLength,freeMode:!0,watchSlidesProgress:!0,modules:p.modules},{default:P(()=>[(T(!0),E(L,null,F(g.images,(n,s)=>(T(),z(_,{class:X({"swiper-slide-thumb-active":w.activeSlideIndex===s}),key:s},{default:P(()=>[i("img",{class:"pointer w-100",src:n,alt:"",style:{height:"100px"}},null,8,ne)]),_:2},1032,["class"]))),128))]),_:1},8,["onSwiper","slidesPerView","modules"])],64)}const le=H(re,[["render",ae],["__scopeId","data-v-4b3fef2b"]]),de={data(){return{qty:1}},methods:{...$(Q,["getProduct"]),...$(G,["addToCart"]),addQty(){this.qty<20&&(this.qty+=1)},subQty(){this.qty>1&&(this.qty-=1)}},mounted(){const{id:m}=this.$route.params;this.getProduct(m)},computed:{...N(Q,["currentProduct"]),...N(G,["carts"])},components:{ProductDetailSwiper:le}},q=m=>(Y("data-v-d3a7e618"),m=m(),J(),m),ce={class:"py-12"},ue={class:"container"},me={class:"mb-6","aria-label":"breadcrumb"},pe={class:"breadcrumb"},fe={class:"breadcrumb-item"},he={class:"breadcrumb-item active","aria-current":"page"},be={class:"row"},we={class:"col-md-7"},ve={class:"col-md-5"},_e={class:"border-bottom mb-10"},ge={class:"fs-11"},ye={class:"d-block my-3 text-gray"},Te=q(()=>i("i",{class:"bi bi-geo-alt-fill me-2"},null,-1)),Se={class:"col-md-12 border-bottom pb-10"},xe={class:"col-md-12 rounded-5 bg-gray300 p-6 mt-10"},Me={class:"fs-11 mb-2"},Pe={class:"fs-5 mb-6"},Ie={class:"d-flex"},Ce={class:"d-flex me-5"},ke=["disabled"],Ee=q(()=>i("i",{class:"bi bi-dash fs-4"},null,-1)),Be=[Ee],Ae=["value"],De=["disabled"],Le=q(()=>i("i",{class:"bi bi-plus fs-4"},null,-1)),Ve=[Le];function Oe(m,e,g,h,p,w){const _=B("RouterLink"),b=B("ProductDetailSwiper");return T(),E("main",ce,[i("div",ue,[i("nav",me,[i("ol",pe,[i("li",fe,[A(_,{to:"/products"},{default:P(()=>[k("推薦行程")]),_:1})]),i("li",he,y(this.currentProduct.title),1)])]),i("div",be,[i("div",we,[A(b,{images:this.currentProduct.imagesUrl},null,8,["images"])]),i("div",ve,[i("div",_e,[i("h2",ge,y(this.currentProduct.title),1),i("span",ye,[Te,k(y(this.currentProduct.category),1)])]),i("div",Se,[i("p",null,y(this.currentProduct.description),1)]),i("div",xe,[i("div",Me,y(parseInt(this.currentProduct.price).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,","))+" 元",1),i("div",Pe,[k("原價 "),i("del",null,y(parseInt(this.currentProduct.origin_price).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")),1),k(" 元")]),i("div",Ie,[i("div",Ce,[i("button",{type:"button",class:"borderRounded me-2",onClick:e[0]||(e[0]=V(n=>w.subQty(),["prevent"])),disabled:p.qty===1},Be,8,ke),i("input",{type:"number",class:"form-control border-0 fs-4 me-2",style:{width:"80px"},min:"1",value:p.qty,readonly:""},null,8,Ae),i("button",{type:"button",class:"borderRounded",onClick:e[1]||(e[1]=V(n=>w.addQty(),["prevent"])),disabled:p.qty===20},Ve,8,De)]),i("button",{type:"button",class:"btn btn-primary",style:{width:"200px"},onClick:e[2]||(e[2]=V(n=>m.addToCart(this.currentProduct.id,this.$router.push,this.qty),["prevent"]))}," 加入購物車 ")])])])])])])}const Ne=H(de,[["render",Oe],["__scopeId","data-v-d3a7e618"]]);export{Ne as default};
